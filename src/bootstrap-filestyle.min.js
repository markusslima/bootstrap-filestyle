/*
 * bootstrap-filestyle
 * doc: http://markusslima.github.io/bootstrap-filestyle/
 * github: https://github.com/markusslima/bootstrap-filestyle
 *
 * Copyright (c) 2017 Markus Vinicius da Silva Lima
 * Version 2.1.0
 * Licensed under the MIT license.
 */
!function(o){"use strict";var n=0,r=function(e,t){this.options=t,this.$elementFilestyle=[],this.$element=o(e)};r.prototype={clear:function(){this.$element.val(""),this.$elementFilestyle.find(":text").val(""),this.$elementFilestyle.find(".badge").remove()},destroy:function(){this.$element.removeAttr("style").removeData("filestyle"),this.$elementFilestyle.remove()},disabled:function(e){if(!0!==e&&!1!==e)return this.options.disabled;this.options.disabled=e,this.$element.prop("disabled",this.options.disabled),this.$elementFilestyle.find("label").prop("disabled",this.options.disabled),this.options.disabled?this.$elementFilestyle.find("label").css("opacity","0.65"):this.$elementFilestyle.find("label").css("opacity","1")},dragdrop:function(e){if(!0!==e&&!1!==e)return this.options.dragdrop;this.options.dragdrop=e},buttonBefore:function(e){if(!0===e)this.options.buttonBefore||(this.options.buttonBefore=e,this.options.input&&(this.$elementFilestyle.remove(),this.constructor(),this.pushNameFiles()));else{if(!1!==e)return this.options.buttonBefore;this.options.buttonBefore&&(this.options.buttonBefore=e,this.options.input&&(this.$elementFilestyle.remove(),this.constructor(),this.pushNameFiles()))}},input:function(e){if(!0===e)this.options.input||(this.options.input=e,this.options.buttonBefore?this.$elementFilestyle.append(this.htmlInput()):this.$elementFilestyle.prepend(this.htmlInput()),this.pushNameFiles(),this.$elementFilestyle.find(".group-span-filestyle").addClass("input-group-btn"));else{if(!1!==e)return this.options.input;this.options.input&&(this.options.input=e,this.$elementFilestyle.find(":text").remove(),this.$elementFilestyle.find(".group-span-filestyle").removeClass("input-group-btn"))}},size:function(e){if(void 0===e)return this.options.size;this.options.size=e;var t=this.$elementFilestyle.find("label"),i=this.$elementFilestyle.find("input");t.removeClass("btn-lg btn-sm"),i.removeClass("form-control-lg form-control-sm"),"nr"!=this.options.size&&(t.addClass("btn-"+this.options.size),i.addClass("form-control-"+this.options.size))},placeholder:function(e){if(void 0===e)return this.options.placeholder;this.options.placeholder=e,this.$elementFilestyle.find("input").attr("placeholder",e)},text:function(e){if(void 0===e)return this.options.text;this.options.text=e,this.$elementFilestyle.find("label .text").html(this.options.text)},btnClass:function(e){if(void 0===e)return this.options.btnClass;this.options.btnClass=e,this.$elementFilestyle.find("label").attr({class:"btn "+this.options.btnClass+" btn-"+this.options.size})},badge:function(e){if(!0===e){this.options.badge=e;var t=this.pushNameFiles();this.$elementFilestyle.find("label").append(' <span class="badge '+this.options.badgeName+'">'+t.length+"</span>")}else{if(!1!==e)return this.options.badge;this.options.badge=e,this.$elementFilestyle.find(".badge").remove()}},badgeName:function(e){if(void 0===e)return this.options.badgeName;this.options.badgeName=e,this.$elementFilestyle.find(".badge").attr({class:"badge "+this.options.badgeName})},htmlIcon:function(e){return void 0!==e&&(this.options.htmlIcon=e),this.options.htmlIcon},htmlInput:function(){return this.options.input?'<input type="text" class="form-control '+("nr"==this.options.size?"":"form-control-"+this.options.size)+'" placeholder="'+this.options.placeholder+'" disabled> ':""},pushNameFiles:function(){var e="",t=[];void 0===this.$element[0].files?t[0]={name:this.$element[0]&&this.$element[0].value}:t=this.$element[0].files;for(var i=0;i<t.length;i++)e+=t[i].name.split("\\").pop()+", ";return""!==e?this.$elementFilestyle.find(":text").val(e.replace(/\, $/g,"")):this.$elementFilestyle.find(":text").val(""),t},constructor:function(){var e,t,i=this,s=i.$element.attr("id");""!==s&&s||(s="filestyle-"+n,i.$element.attr({id:s}),n++),t='<span class="group-span-filestyle '+(i.options.input?"input-group-btn":"")+'"><label for="'+s+'" style="margin-bottom: 0;" class="btn '+i.options.btnClass+" "+("nr"==i.options.size?"":"btn-"+i.options.size)+'" '+(i.options.disabled||i.$element.attr("disabled")?' disabled="true"':"")+">"+i.htmlIcon()+'<span class="buttonText">'+i.options.text+"</span></label></span>",e=i.options.buttonBefore?t+i.htmlInput():i.htmlInput()+t,i.$elementFilestyle=o('<div class="bootstrap-filestyle input-group"><div name="filedrag"></div>'+e+"</div>"),i.$elementFilestyle.find(".group-span-filestyle").attr("tabindex","0").keypress(function(e){if(13===e.keyCode||32===e.charCode)return i.$elementFilestyle.find("label").click(),!1}),i.$element.css({position:"absolute",clip:"rect(0px 0px 0px 0px)"}).attr("tabindex","-1").after(i.$elementFilestyle),"rtl"===o("html").attr("dir")||"rtl"===o("body").css("direction")?!0===i.options.buttonBefore?(i.$elementFilestyle.find("label").css({"border-top-left-radius":"0rem","border-bottom-left-radius":"0rem"}),i.$elementFilestyle.find(":input").css({"border-top-left-radius":".25rem","border-bottom-left-radius":".25rem","border-top-right-radius":"0rem","border-bottom-right-radius":"0rem"})):(i.$elementFilestyle.find(":input").css({"border-top-right-radius":".25rem","border-bottom-right-radius":".25rem","border-top-left-radius":"0rem","border-bottom-left-radius":"0rem"}),i.$elementFilestyle.find("label").css({"border-top-right-radius":"0rem","border-bottom-right-radius":"0rem"})):!0===i.options.buttonBefore?(i.$elementFilestyle.find("label").css({"border-top-right-radius":"0rem","border-bottom-right-radius":"0rem"}),i.$elementFilestyle.find(":input").css({"border-top-left-radius":"0rem","border-bottom-left-radius":"0rem"})):(i.$elementFilestyle.find(":input").css({"border-top-left-radius":".25rem","border-bottom-left-radius":".25rem","border-top-right-radius":"0rem","border-bottom-right-radius":"0rem"}),i.$elementFilestyle.find("label").css({"border-top-left-radius":"0rem","border-bottom-left-radius":"0rem"})),i.$elementFilestyle.find('[name="filedrag"]').css({position:"absolute",width:"100%",height:i.$elementFilestyle.height()+"px","z-index":-1}),(i.options.disabled||i.$element.attr("disabled"))&&(i.$element.attr("disabled","true"),i.options.disabled?i.$elementFilestyle.find("label").css("opacity","0.65"):i.$elementFilestyle.find("label").css("opacity","1")),i.$element.change(function(){var e=i.pushNameFiles();i.options.badge?0==i.$elementFilestyle.find(".badge").length?i.$elementFilestyle.find("label").append(' <span class="badge '+i.options.badgeName+'">'+e.length+"</span>"):0==e.length?i.$elementFilestyle.find(".badge").remove():i.$elementFilestyle.find(".badge").html(e.length):i.$elementFilestyle.find(".badge").remove(),i.options.onChange(e)}),-1<window.navigator.userAgent.search(/firefox/i)&&i.$elementFilestyle.find("label").click(function(){return i.$element.click(),!1}),o(document).on("dragover",function(e){e.preventDefault(),e.stopPropagation(),i.options.dragdrop&&o('[name="filedrag"]').css("z-index","9")}).on("drop",function(e){e.preventDefault(),e.stopPropagation(),i.options.dragdrop&&o('[name="filedrag"]').css("z-index","-1")}),i.$elementFilestyle.find('[name="filedrag"]').on("dragover",function(e){e.preventDefault(),e.stopPropagation()}).on("dragenter",function(e){e.preventDefault(),e.stopPropagation()}).on("drop",function(e){if(e.originalEvent.dataTransfer&&!i.options.disabled&&i.options.dragdrop&&e.originalEvent.dataTransfer.files.length){e.preventDefault(),e.stopPropagation(),i.$element[0].files=e.originalEvent.dataTransfer.files;var t=i.pushNameFiles();i.options.badge?0==i.$elementFilestyle.find(".badge").length?i.$elementFilestyle.find("label").append(' <span class="badge '+i.options.badgeName+'">'+t.length+"</span>"):0==t.length?i.$elementFilestyle.find(".badge").remove():i.$elementFilestyle.find(".badge").html(t.length):i.$elementFilestyle.find(".badge").remove(),o('[name="filedrag"]').css("z-index","-1")}})}};var e=o.fn.filestyle;o.fn.filestyle=function(s,n){var l="",e=this.each(function(){if("file"===o(this).attr("type")){var e=o(this),t=e.data("filestyle"),i=o.extend({},o.fn.filestyle.defaults,s,"object"==typeof s&&s);t||(e.data("filestyle",t=new r(this,i)),t.constructor()),"string"==typeof s&&(l=t[s](n))}});return void 0!==typeof l?l:e},o.fn.filestyle.defaults={text:"Choose file",htmlIcon:"",btnClass:"btn-secondary",size:"nr",input:!0,badge:!1,badgeName:"badge-light",buttonBefore:!1,dragdrop:!0,disabled:!1,placeholder:"",onChange:function(){}},o.fn.filestyle.noConflict=function(){return o.fn.filestyle=e,this},o(function(){o(".filestyle").each(function(){var e=o(this),t={input:"false"!==e.attr("data-input"),htmlIcon:e.attr("data-icon"),buttonBefore:"true"===e.attr("data-buttonBefore"),disabled:"true"===e.attr("data-disabled"),size:e.attr("data-size"),text:e.attr("data-text"),btnClass:e.attr("data-btnClass"),badge:"true"===e.attr("data-badge"),dragdrop:"false"!==e.attr("data-dragdrop"),badgeName:e.attr("data-badgeName"),placeholder:e.attr("data-placeholder")};e.filestyle(t)})})}(window.jQuery);
